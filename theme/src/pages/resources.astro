---
import Layout from '../layouts/Page.astro';
import HeroSection from '../components/heros/HeroSection.astro';
import resourceContent from '../../public/cms/resources.json';
import CtaGeneral from '../components/CtaGeneral.astro';
import CustomerQuoteSection from '../components/sections/CustomerQuoteSection.astro';
import { Resource } from '../models/resource';
import YouTubeEmbed from '../components/core/YouTubeEmbed.astro';
import Button from '../components/buttons/Button.astro';
import { Icon } from 'astro-icon';
import Container from '../components/Container.astro';

//const resourceLinks = await Astro.glob<Resource>('../../public/cms/ResourceLinks/*.json');

const seo = {
	title: 'Resources | Empowered Healing Counseling - Meaghan Trezza, LMHC',
	description: 'Resources and links for depression anxiety and drama. Meaghan Trezza, LMHC, is a Somatic Experiencing Practitioner in Tacoma, WA.',
};

const resources =  await Astro.glob<Resource>('../../public/cms/ResourceLinks/*.json');


---

<Layout {seo}>
	<HeroSection>
		<div slot="text-container">
			<h1>Resources</h1>
		</div>
		<picture slot="image-container">
			<img
				width="828"
				height="414"
				id="rai-hero"
				src="/assets/images/helpful-resources.webp"
				alt="Helpful resources for depression, anxiety, and trauma"
				loading="eager"
			/>
		</picture>
	</HeroSection>

	<CustomerQuoteSection
		quoteText={resourceContent.quote}
		customerName={resourceContent.quoteAuthor}
	/>

    <Container>
        <div class="resources-grid">
            {
                resources.map((resource: Resource) => {
                    const isVideo = resource.resourceLink.includes('youtube') || resource.youtubeLink;
                    return (
                        <article class="resource-card">
                            <div class="resource-card__media">
                                {isVideo ? (
                                    <YouTubeEmbed url={resource.resourceLink} />
                                ) : (
                                    <div class="resource-card__icon-placeholder">
                                        <Icon name="ph:link-bold" />
                                    </div>
                                )}
                            </div>
                            <div class="resource-card__content">
                                <div class="resource-card__header">
                                    <span class={`resource-type ${isVideo ? 'video' : 'link'}`}>
                                        {isVideo ? 'Video' : 'Article / Website'}
                                    </span>
                                    <h3>{resource.title}</h3>
                                </div>
                                <p>{resource.description}</p>
                                <div class="resource-card__footer">
                                    <Button href={resource.resourceLink} target="_blank" unelevated customIcon newTab>
                                        {isVideo ? 'Watch Video' : 'Visit Resource'}
                                        <Fragment slot="icon">
                                            <Icon name={isVideo ? "ph:play-circle" : "la:external-link-alt"}/>
                                        </Fragment>
                                    </Button>
                                </div>
                            </div>
                        </article>
                    )
                })
            }
        </div>
    </Container>
       
	<CtaGeneral />
</Layout>

<style>
    .resources-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2rem;
        margin: var(--section-margin) auto;
    }

    .resource-card {
        background: var(--theme-surface-1);
        border-radius: var(--theme-shape-radius);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: 1px solid rgba(0,0,0,0.05);
        height: 100%;
    }

    .resource-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .resource-card__media {
        background: var(--theme-surface-2);
        min-height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }
    
    /* Override YouTube embed styles to fit card */
    .resource-card__media :global(.youtube-embed__container) {
        width: 100%;
        margin-bottom: 0;
        border-radius: 0;
        height: 100%;
        aspect-ratio: 16/9;
    }

    .resource-card__icon-placeholder {
        color: var(--theme-primary);
        opacity: 0.5;
        padding: 3rem;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
    }

    .resource-card__content {
        padding: 2rem;
        display: flex;
        flex-direction: column;
        flex-grow: 1;
    }

    .resource-card__header {
        margin-bottom: 1rem;
    }

    .resource-type {
        display: inline-block;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 600;
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        margin-bottom: 0.75rem;
    }

    .resource-type.video {
        background-color: #ffebee;
        color: #c62828;
    }

    .resource-type.link {
        background-color: #e3f2fd;
        color: #1565c0;
    }

    .resource-card h3 {
        font-size: 1.5rem;
        margin: 0;
        line-height: 1.3;
        color: var(--theme-on-surface);
        font-weight: 600;
    }

    .resource-card p {
        color: var(--theme-on-surface-1);
        line-height: 1.6;
        margin-bottom: 2rem;
        flex-grow: 1;
    }

    .resource-card__footer {
        margin-top: auto;
    }

    [astro-icon] {
        width: 1.5rem;
        height: 1.5rem;
    }
    
    .resource-card__icon-placeholder [astro-icon] {
        width: 4rem;
        height: 4rem;
    }

    @media (max-width: 768px) {
        .resources-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
